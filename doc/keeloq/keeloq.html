<h1>Keeloq for ChipWhisperer</h1>

<p>This is a set of tools to perform power analysis of the Keeloq cipher.
It is based on and integrated with the ChipWhisperer software.  Tutorials
and example traces are provided for a quick learning experience.</p>

<p>Implementation and documentation copyright 2016 by Marc.</p>

<hr />

<h2>Toolset overview</h2>

<h3>Keeloq data capture</h3>

<p>Loose collection of utilities to capture Keeloq data transmissions and
annotate them to the power traces.</p>

<ul>
<li>GNURadio flow to receive and demodulate RF messages</li>
<li>Keeloq OOK decoder to convert baseband to HEX values</li>
<li>Script to annotate HEX values to traces captured with ChipWhisperer</li>
</ul>

<h3>Preprocessing filter: Resync Slice-to-Slot</h3>

<p>Powerful plugin to prepare traces for analysis.</p>

<ul>
<li>Compensate for internal RC oscillator drift (HCSxxx)</li>
<li>Extract arbitrary point ranges from each round</li>
<li>Compress ranges to one peak per round</li>
</ul>

<h3>Trace Explorer partition modes: Keeloq (various)</h3>

<p>Several partition modes relevant to the Keeloq algorithm.  Useful for visual
exploration, understanding the attacks, and even executing them manually.</p>

<ul>
<li><strong>Bit (various)</strong>: Partition by ciphertext output or intermediate
                   LSB/MSB value</li>
<li><strong>HD (various)</strong>:  Partition by Hamming distance of status register
                   during shift operations</li>
</ul>

<h3>Attack module: Keeloq DPA</h3>

<p>Container for several automatted attacks:</p>

<ul>
<li><strong>Encoder Bit model</strong>: Attacks the intermediate MSB bit value.</li>
<li><strong>Encoder HD model</strong>:  Attacks the status register Hamming distance
                       during shift operations.</li>
</ul>

<hr />

<h2>Example traces</h2>

<h3>HCS301 raw</h3>

<p>Useful to study trace preparation.  Contains synchronization issues
(RC oscillator clock drift).</p>

<ul>
<li>500 semi-consecutive messages</li>
<li>48.2 MHz sample rate (approx 200 samples per cipher round)</li>
<li>Covers last 100 rounds (approx)</li>
<li>Captured with ChipWhisperer CW1002 hardware kit</li>
</ul>

<h3>HCS301 sync</h3>

<p>Derived from <strong>HCS301 raw</strong>, with clock drift compensated and freaks removed.
Useful to study any aspect of the power behavior.</p>

<ul>
<li>500 semi-consecutive messages</li>
<li>200 samples per cipher round</li>
<li>Covers last 100 rounds (approx)</li>
</ul>

<h3>HCS301 bits (full / peak)</h3>

<p>Derived from <strong>HCS301 sync</strong>, trimmed to just the point range where MSB/LSB
bit values leak.</p>

<ul>
<li>500 semi-consecutive messages</li>
<li><strong>### FIXME ###</strong> samples per cipher round</li>
<li>Cover last 100 rounds (approx)</li>
</ul>

<h3>HCS301 shift (full / peak)</h3>

<p>Derived from <strong>HCS301 sync</strong>, trimmed to just the point range where the
status register leaks.</p>

<ul>
<li>500 semi-consecutive messages</li>
<li><strong>### FIXME ###</strong> samples per cipher round</li>
<li>Cover last 100 rounds (approx)</li>
</ul>

<hr />

<h2>Tutorial overview</h2>

<h3>The Keeloq algorithm</h3>

<p>Rehash of available information about the Keeloq algorithm.</p>

<ul>
<li>Algorithm description</li>
<li>Source code</li>
<li>Existing implementations</li>
</ul>

<h3>Capture power consumption of HCS301</h3>

<ul>
<li>Prepare victim (GND shunt)</li>
<li>Connect CW1002 and differential probe</li>
<li>Configure CW Capture software</li>
<li>Find suitable triggers</li>
</ul>

<h3>Capture ciphertext of HCS301 with GNU Radio</h3>

<ul>
<li>Configure GNU Radio live-boot environment</li>
<li>Prepare reception of RF messages</li>
<li>Perform capture of power and RF data simultaneously</li>
<li>Annotate ciphertext data to power traces</li>
</ul>

<h3>Preparation of traces</h3>

<ul>
<li>Compensate for clock drift and eliminate freaks</li>
<li>Recover Keeloq round timing</li>
<li>Identify and extract interesting point ranges</li>
<li>Compress to peaks</li>
<li>Export polished results</li>
</ul>

<h3>Bit model attack on Keeloq</h3>

<p><strong>### TODO ###</strong></p>

<h3>Hamming distance model attack on Keeloq</h3>

<p><strong>### TODO ###</strong></p>

<hr />

<h1>Thanks</h1>

<p>Thanks to <em>Colin O'Flynn</em> for making ChipWhisperer open-source.  This
extension would not exist otherwise.  Also, because of it, I learned
python, git, and markdown.  Thanks for that!</p>

<hr />

<p><em>Document version: 08-Sep-2016</em></p>
